version: 2

models:
  - name: fct_sales
    description: "Fact table for sales at the order grain. Contains one row per order with aggregated metrics."
    columns:
      - name: order_id
        description: "Primary key - unique identifier for the order"
        tests:
          - unique
          - not_null
      - name: order_date
        description: "Date when the order was placed"
        tests:
          - not_null
      - name: order_status
        description: "Status code (1=Pending, 2=Processing, 3=Rejected, 4=Completed)"
      - name: total_revenue
        description: "Total revenue from the order after discounts"
      - name: total_discount
        description: "Total discount amount applied to the order"
      - name: store_name
        description: "Name of the store where order was placed"
      - name: staff_full_name
        description: "Name of staff member who processed the order"

  - name: fct_sales_by_product
    description: "Fact table for sales at the order line item grain. Contains one row per product per order."
    columns:
      - name: order_id
        description: "Foreign key to the order"
        tests:
          - not_null
      - name: product_id
        description: "Foreign key to the product"
        tests:
          - not_null
      - name: revenue
        description: "Revenue for this line item after discount"
      - name: quantity
        description: "Number of units sold"

  - name: dim_products
    description: "Product dimension table with brand, category, and stock information"
    columns:
      - name: product_id
        description: "Primary key for products"
        tests:
          - unique
          - not_null
      - name: product_name
        description: "Name of the product"
      - name: brand_name
        description: "Brand of the product"
      - name: category_name
        description: "Category of the product"
      - name: stock_status
        description: "Current stock status (In Stock, Low Stock, Out of Stock)"

  - name: dim_stores
    description: "Store dimension table with staff and inventory counts"
    columns:
      - name: store_id
        description: "Primary key for stores"
        tests:
          - unique
          - not_null
      - name: store_name
        description: "Name of the store"
      - name: store_state
        description: "US State where store is located"

  - name: dim_customers
    description: "Customer dimension table with purchase history metrics"
    columns:
      - name: customer_id
        description: "Primary key for customers"
        tests:
          - unique
          - not_null
      - name: customer_full_name
        description: "Full name of the customer"
      - name: customer_segment
        description: "Customer segment based on purchase frequency"
      - name: lifetime_revenue
        description: "Total revenue from this customer"

  - name: agg_sales_by_store_month
    description: "Monthly sales aggregation by store for trend analysis"
    columns:
      - name: store_id
        description: "Store identifier"
      - name: month_date
        description: "First day of the month"
      - name: total_revenue
        description: "Total revenue for the store in this month"

  - name: agg_sales_by_category
    description: "Yearly sales aggregation by product category"
    columns:
      - name: category_name
        description: "Product category name"
      - name: total_revenue
        description: "Total revenue for this category"

  - name: agg_sales_by_brand
    description: "Yearly sales aggregation by brand"
    columns:
      - name: brand_name
        description: "Brand name"
      - name: total_revenue
        description: "Total revenue for this brand"

  - name: agg_staff_performance
    description: "Yearly performance metrics by staff member"
    columns:
      - name: staff_id
        description: "Staff member identifier"
      - name: staff_full_name
        description: "Full name of staff member"
      - name: total_revenue
        description: "Total revenue generated by this staff member"
      - name: total_orders
        description: "Number of orders processed"
